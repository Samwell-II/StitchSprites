# StitchSprites
Python program that takes a folder of separate sprites and packs them into a sprite sheet.

1. [Example process](#example-process)
2. [ImageBatch methods](#imagebatch-methods)
3. [Arguments](#arguments)

# Example process
In the given example.py this program completes the following process:

1) Loads images from user's specified folder into ImageBatch object. 

2) ImageBatch.batch_process(ImageBatch.find_borders) is used to find borders in each image.

![Resulting image](https://github.com/alisev/StitchSprites/blob/master/example%20images/borders.png)

3) ImageBatch.minmax_borders() is then used to find the most optimal borders, that will not cut off a part of a sprite.

![Resulting image](https://github.com/alisev/StitchSprites/blob/master/example%20images/optimal_border.png)

![Resulting image](https://github.com/alisev/StitchSprites/blob/master/example%20images/optimal_borders_2.png)

4) To crop images ImageBatch.crop_image along with the result from 3rd step is passed to ImageBatch.batch_process().

5) Finally, the cropped sprites are put together in a single file with ImageBatch.stitch(). The created image can be saved with ImageBatch.save().

![Resulting image](https://github.com/alisev/StitchSprites/blob/master/output/sprite_sheet.png)


# ImageBatch methods
## __init__
Initializes the object by assigning values to ImageBatch.root, ImageBatch.paths and ImageBatch.bg_color.

Parameters:
* dir: string
    - Path to folder of sprites.
* bg_color: {tuple, None}, optional
    - Background color used in sprites. If it is set as None, then program will find it on its own.
* sort_natural: bool, optional
    - Specifies if folder's contents need to be sorted.

## __load_filenames
Used during object initiation. Loads all filenames from given directory dir into a list. Will sort them, if argument natural_sort is set to True.

Parameters:
* dir: string
    - Path to folder of sprites.
* sort_natural: bool
    - Specifies if folder's contents need to be sorted.

Returns: list
    - List of filenames.

## __set_bg_color
Used during object initiation. Picks background color from an image or uses the one passed by user.

Parameters:
* bg_color: {tuple, None}
    - Background color used in sprites. If it is set as None, then program will find it on its own.

Returns: tuple
    - Background color value.

## get_image_path
Combines ImageBatch.root with given identifier to image path into a single filepath.

Parameters:
* identifier: {int, str}
    - Some value representing a path from ImageBatch.paths. Can be either an index number or filename itself.

Returns: str
    - Full path to file.

## show_image
Shows image.

Parameters:
* image: Image
    - A PIL image object.

## batch_process
A function that accepts any other ImageBatch method as an argument and processes all images with it.

Parameters:
* image_fn: function
    - A function to use to edit images in batch.
* args: tuple
    - Values to pass to function as arguments.
* every: int, optional
    - Specifies how often user should be notified about function's progress.

Returns: list
    - List of returned values by image_fn.

## find_borders
Finds borders of a sprite in a single image.

Parameters:
* image: Image
    - A PIL image object.

Returns: tuple or None
    - Border coordinates or None if sprite is empty.

## minmax_borders
Takes a list of borders generated by find_borders and finds the largest space that can contain the sprite.

Parameters:
* borders: list
    - The most optimal border coordinates for cropping a sprite.

## crop_image
Crops image with given border values.

Parameters:
* image: Image
    - A PIL image object.
* min_x, min_y, max_x, max_y: int
    - Border coordinates

Returns: Image
    - Cropped image.

## stitch
Creates empty canvas and places all cropped sprites in it.

Parameters:
* images: list
    - List of images to combine into a single spritesheet
* x, y: int
    - Specifies number of images to tile horizontally and vertically.

Returns: Image
    - Spritesheet.

## save
Saves image.

Parameters:
* image: Image
    - A PIL image object.
* name: str:
    - Filename for the image.

## __progress_message
Shows how many images have been processed. Used by batch_process.

Parameters:
* image: Image
    - A PIL image object.

## __get_pixel_mask
Overlays ImageBtach.bg_color over image's pixels and creates a mask. Used by find_borders.

Parameters:
* image: Image
    - A PIL image object.

Returns: np.ndarray
    - Mask version of input image.

## __err_TypeError_message
Returns text used in TypeError message.

Parameters:
* var: any
    - Erroneous variable.
* fn: function
    - The function where error happened.
* expected_types: list
    - List of types that were expected.

Returns: str
